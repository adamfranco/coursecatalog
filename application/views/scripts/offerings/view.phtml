<?php
// print "\n\t<div>".$this->escape($this->offering->getDisplayName())."</div>";
print "\n\t<h2>\"".$this->escape($this->offering->getTitle())."\"</h2>";
if ($this->offering->getDescription())
	print "\n\t<div>".$this->escape($this->offering->getDescription())."</div>";

$resourceParams = array(
							'controller'	=> 'resources',
							'action'		=> 'view',
							'offering'		=> null
						);

$term = $this->offering->getTerm();
$termUrl = $this->url(array(
						'controller'	=> 'terms',
						'action'		=> 'view',
						'term'			=> AbstractCatalogController::getStringFromOsidId($term->getId()),
						'offering'		=> null
					));
print "\n\t<dl>";
print "\n\t\t<dt>Term:</dt>";
print "\n\t\t<dd><a href='".$termUrl."'>".$this->escape($term->getDisplayName())."</a></dd>";
print "\n\t\t<dt>Location:</dt>";
if ($this->offering->hasLocation()) {
	print "\n\t\t<dd>";
	$locationResource = $this->offering->getLocation();
	$resourceParams['resource'] = AbstractCatalogController::getStringFromOsidId($locationResource->getId());
	print "<a href=\"".$this->url($resourceParams)."\">";
	print $this->escape($locationResource->getDisplayName());
	print "</a> ";
	if ($locationResource->getDescription())
		print "<span class='location_description'>(".$this->escape($locationResource->getDescription()).")</span>";
	print "\n\t\t</dd>";
} else {
	print "\n\t\t<dd>".$this->escape($this->offering->getLocationInfo())."</dd>";
}
print "\n\t\t<dt>Schedule:</dt>";
print "\n\t\t<dd>".$this->escape($this->offering->getScheduleInfo())."</dd>";
print "\n\t\t<dt>Type:</dt>";
print "\n\t\t<dd>".$this->escape($this->offering->getGenusType()->getDisplayName())."</dd>";

$instructorsType = new phpkit_type_URNInetType('urn:inet:middlebury.edu:record:instructors');
if ($this->offering->hasRecordType($instructorsType)) {
	$instructorsRecord = $this->offering->getCourseOfferingRecord($instructorsType);
	print "\n\t\t<dt>Instructors:</dt>";
	print "\n\t\t<dd>";
	$instructors = $instructorsRecord->getInstructors();
	while ($instructors->hasNext()) {
		$instructor = $instructors->getNextResource();
		$resourceParams['resource'] = AbstractCatalogController::getStringFromOsidId($instructor->getId());
		print "<a href=\"".$this->url($resourceParams)."\">";
		print $this->escape($instructor->getDisplayName());
		print "</a> ";
	}
	print "</dd>";
}
// Topics
$topicParams = array(
						'controller'	=> 'topics',
						'action'		=> 'view',
						'offering'		=> null,
						'term'			=> AbstractCatalogController::getStringFromOsidId($term->getId())
					);
print "\n\t<dt>Subject:</dt>";
print "\n\t\t<dd>";
foreach ($this->subjectTopics as $topic) {
	$topicParams['topic'] = AbstractCatalogController::getStringFromOsidId($topic->getId());
	print "<a href=\"".$this->url($topicParams)."\">";
	print $this->escape($topic->getDisplayName());
	print "</a> ";
}
print "</dd>";

print "\n\t\t<dt>Department:</dt>";
print "\n\t\t<dd>";
foreach ($this->departmentTopics as $topic) {
	$topicParams['topic'] = AbstractCatalogController::getStringFromOsidId($topic->getId());
	print "<a href=\"".$this->url($topicParams)."\">";
	print $this->escape($topic->getDisplayName());
	print "</a> ";
}
print "</dd>";

print "\n\t\t<dt>Division:</dt>";
print "\n\t\t<dd>";
foreach ($this->divisionTopics as $topic) {
	$topicParams['topic'] = AbstractCatalogController::getStringFromOsidId($topic->getId());
	print "<a href=\"".$this->url($topicParams)."\">";
	print $this->escape($topic->getDisplayName());
	print "</a> ";
}
print "</dd>";

print "\n\t\t<dt>Requirements Fulfilled:</dt>";
print "\n\t\t<dd>";
foreach ($this->requirementTopics as $topic) {
	$topicParams['topic'] = AbstractCatalogController::getStringFromOsidId($topic->getId());
	print "<a href=\"".$this->url($topicParams)."\">";
	print $this->escape($topic->getDisplayName());
	print "</a> ";
}
print "</dd>";

print "\n\t</dl>";

$course = $this->offering->getCourse();
$courseParams = array(
						'controller'	=> 'courses',
						'action'		=> 'view',
						'course'		=> AbstractCatalogController::getStringFromOsidId($course->getId()),
						'offering'		=> null
					);
print "\n\t<h2>Course</h2>";
print "\n\t<div><a href='".$this->url($courseParams)."'>".$this->escape($course->getDisplayName())."</a></div>";

$offeringParams = array(	
						'controller' 	=> 'offerings',
						'action'		=> 'view',
						'course'		=> null
					);

if (isset($this->parentOffering)) {
	$offeringParams['offering'] = AbstractCatalogController::getStringFromOsidId($this->parentOffering->getId());
	print "\n\t	<h2>Offering</h2>";
print "\n\t\t<div><a href='".$this->url($offeringParams)."'>".$this->escape($section->getDisplayName())."</a></div>";
}